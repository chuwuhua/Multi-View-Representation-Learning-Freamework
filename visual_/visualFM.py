fm = [[0.0411, -0.0111, 0.0632, 0.0098, -0.0604, 0.0997, -0.1139, -0.0225],
      [-0.0040, -0.0400, -0.0674, -0.0328, 0.0526, -0.0573, 0.0991, -0.0063],
      [-0.1684, -0.0148, -0.0371, -0.0842, 0.1024, -0.1295, 0.0305, 0.0386],
      [-0.2081, 0.2072, -0.0422, 0.0484, 0.1861, -0.1504, -0.1369, 0.1394],
      [-0.1906, 0.0055, -0.2104, 0.1819, 0.0190, -0.2138, -0.0879, 0.0781],
      [0.0169, 0.0498, -0.0283, -0.0427, -0.1457, -0.0756, 0.0338, -0.0660],
      [-0.1041, 0.0108, -0.0743, 0.1095, -0.1574, -0.1692, 0.0483, -0.0003],
      [0.0842, -0.0013, 0.0166, -0.0423, -0.0654, 0.0441, -0.0157, -0.0629],
      [-0.0539, 0.0715, 0.0406, 0.0303, -0.1604, -0.1037, 0.0261, 0.0510],
      [-0.0481, -0.1215, 0.0773, -0.1712, -0.0144, 0.0998, -0.0544, -0.0457],
      [0.0450, 0.0117, -0.0995, -0.0216, 0.0132, 0.1367, -0.0796, 0.0258],
      [-0.0185, 0.0395, -0.0224, -0.0535, 0.0096, -0.0675, -0.0041, -0.0205],
      [0.0278, -0.0907, 0.0032, 0.0467, 0.0641, -0.0579, 0.0101, 0.0116],
      [-0.0868, 0.0340, -0.1127, -0.0209, 0.0884, 0.0504, 0.0122, 0.0331],
      [0.1806, 0.0753, -0.1622, -0.1019, -0.0982, 0.2305, -0.1117, -0.1080],
      [0.0434, 0.0594, -0.0061, 0.0386, 0.0485, 0.0351, -0.0454, -0.0182],
      [0.0043, 0.0732, -0.0720, 0.0809, 0.0311, 0.0833, 0.0263, 0.0273],
      [-0.0027, 0.0521, 0.1233, -0.0088, 0.0583, -0.0865, -0.0520, 0.0074],
      [0.0145, 0.0085, 0.0802, -0.0572, 0.0985, -0.1048, -0.0463, 0.0146],
      [-0.0281, -0.0186, -0.0446, -0.1032, 0.0359, 0.0013, 0.0950, 0.0152],
      [0.0129, -0.0085, -0.0964, 0.0035, -0.1474, -0.0450, -0.0815, 0.0230],
      [0.0810, 0.1167, 0.0301, -0.1337, 0.0138, 0.0312, 0.1176, -0.1129]]
import numpy as np
# fm = np.array(fm).T
# # fm = np.array(fm)*10+1
#
# import matplotlib.pyplot as plt
# import numpy as np
#
# fig, ax = plt.subplots()
# im = ax.imshow(fm)
# # for i in range(len(fm)):
# #     for j in range(len(fm[0])):
# #         text = ax.text(j, i, fm[i][j],
# #                        ha="center",va="center", color="w")
# fig.tight_layout()
# ax.set_xticks([])
# ax.set_yticks([])
# plt.show()

x1 = [1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,1,0]
x2 = [0,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,0,1,0]
x3 = [0,0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,1]
import torch
fm = torch.tensor(fm).float()
for x in [x1,x2,x3]:
      x = torch.tensor(x).float()
      x = torch.diag_embed(x)
      x = torch.matmul(x, fm)
      square_of_sum = torch.sum(x) ** 2
      sum_of_square = torch.sum(x ** 2)
      x = torch.sum(square_of_sum - sum_of_square)
      print(x)
